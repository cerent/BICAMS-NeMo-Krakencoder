# BICAMS-NeMo-Krakencoder

In this repo, we provide the codes of linear regression with the ridge regularization method and related libraries that are applicable to R version 4.4.2. The codes can be used to predict any numerical continuous metrics. These codes were used for our preprint entitled “Predicting cognition using estimated structural and functional connectivity networks and artificial intelligence in multiple sclerosis” https://doi.org/10.1101/2025.03.07.642094<img width="468" height="25" alt="image" src="https://github.com/user-attachments/assets/be689582-491c-4019-86ea-a2719641841c" />


The model was trained with outer and inner loops of k-fold cross-validation (k = 5) to optimize the hyperparameters and test model performance. The inner loop (repeated over 5 different partitions of the training dataset only) optimized the hyperparameter that maximized the correlation for the validation dataset. A model was then fitted using the entire training dataset and this hyperparameter, which was then assessed on the hold-out test set from the outer loop. The outer loop was repeated for 100 different random partitions of the data.

The prediction accuracy was obtained using Spearman's and Pearson's correlation coefficients. Parameter coefficients (beta values of the classification models) and their Haufe-transformed versions were used to assess the variable importance.

We also provide the estimated structural connectomes (eSC) used in our preprint. The eSC metrics were computed using the Network Modification (NeMo) Tool v 2.0 and the lesion masks in 171 multiple sclerosis (MS) patients. The NeMo Tool calculates the streamlines in the reference database (obtained using the deterministic [sd-stream] tractography with MRtrix3 in 420 healthy individuals) that pass through the MS lesion mask provided. It then calculates the eSC by taking the sum of the SIFT2 weights of remaining streamlines connecting pairs of regions, divided by the sum of the two regions’ volumes, averaged over the 420 individuals in the reference set. The eSC metrics were obtained using freesurfer brain atlas (with 68 cortical and 18 subcortical/cerebellum regions). The resulting eSC matrix represents region-to-region connectivity strengths and has a dimension of 86x86 matrix, which is symmetrical (i.e., upper lower of the triangle is equal to the lower triangle of the matrix). In this dataset, we converted the upper triangle of the matrix to a matrix with a 1x3655 dimension. Each row in this file represents the estimated structural connections for one MS patient. Since we included 171 MS patients, this dataset includes 171 rows and 3656 columns, where the first column represents the patient ID and the rest of the columns represent 3655 pairwise connections.

Please contact Ceren Tozlu (tozluceren@gmail.com) for any questions about the repository.
